# CodeReview Agent è®¾è®¡æ–¹æ¡ˆ

## 1. äº§å“å®šä½

**CodeReview Agent** â€” ä¸€ä¸ªé€šç”¨çš„ã€åŸºäºAIçš„CodeReviewæ™ºèƒ½ä½“ï¼Œä»¥GitHub App/GitHub Action/Dockerä¸‰ç§å½¢æ€äº¤ä»˜ï¼Œå¸®åŠ©ç¨‹åºå‘˜è‡ªåŠ¨è¯†åˆ«å“ªäº›ä»£ç å¯æäº¤ã€å“ªäº›éœ€è¦äººå·¥å®¡æ ¸ã€‚

---

## 2. æ ¸å¿ƒèƒ½åŠ›

| èƒ½åŠ› | æè¿° |
|------|------|
| è‡ªåŠ¨é¡¹ç›®åˆ†æ | é¦–æ¬¡è¿è¡Œè‡ªåŠ¨åˆ†ææŠ€æœ¯æ ˆã€ä»£ç é£æ ¼ã€ç›®å½•ç»“æ„ï¼Œç”Ÿæˆç¼“å­˜ |
| æ™ºèƒ½é£é™©è¯„ä¼° | AIæ ¹æ®å˜æ›´å†…å®¹åˆ¤æ–­é£é™©ç­‰çº§ (é«˜/ä¸­/ä½) |
| ç½®ä¿¡åº¦åˆ¤æ–­ | åŸºäºé—®é¢˜æ•°é‡å’Œä¸¥é‡ç¨‹åº¦è®¡ç®—ç½®ä¿¡åº¦ |
| å¤šå½¢æ€äº¤ä»˜ | GitHub App / GitHub Action / Docker |
| å…¨è¯­è¨€æ”¯æŒ | ä»»ä½•ç¼–ç¨‹è¯­è¨€ |
| åŒè¾“å‡º | PRè¯„è®º + MarkdownæŠ¥å‘Š |

---

## 3. ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        æ¥å…¥å±‚ (3ç§å½¢æ€)                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ GitHub App  â”‚    â”‚GitHub Actionâ”‚    â”‚   Docker    â”‚        â”‚
â”‚  â”‚  (å®‰è£…å³ç”¨)  â”‚    â”‚  (workflow) â”‚    â”‚ (è‡ªæ‰˜ç®¡)    â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                   â”‚                   â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         æ ¸å¿ƒå¼•æ“ (LangChain)                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚ Context    â”‚  â”‚ Rule       â”‚  â”‚ Review     â”‚               â”‚
â”‚  â”‚ Analyzer   â”‚  â”‚ Engine     â”‚  â”‚ Agent      â”‚               â”‚
â”‚  â”‚ (é¡¹ç›®åˆ†æ+ç¼“å­˜)â”‚ â”‚ (è§„åˆ™å¼•æ“)  â”‚  â”‚ (AIåˆ¤æ–­+Skills)â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                               â”‚
â”‚  â”‚ Risk       â”‚  â”‚ Output     â”‚                               â”‚
â”‚  â”‚ Calculator â”‚  â”‚ Generator  â”‚                               â”‚
â”‚  â”‚ (ç½®ä¿¡åº¦è®¡ç®—) â”‚  â”‚ (æŠ¥å‘Šç”Ÿæˆ)  â”‚                               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         é…ç½®å±‚                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ .codereview-agent.yaml (ç”¨æˆ·é…ç½®)                        â”‚   â”‚
â”‚  â”‚ â€¢ llm: provider, apiKey, model, base_url               â”‚   â”‚
â”‚  â”‚ â€¢ criticalPaths: [src/auth, src/payment]                â”‚   â”‚
â”‚  â”‚ â€¢ excludePatterns: [*.test.ts, *.spec.ts]              â”‚   â”‚
â”‚  â”‚ â€¢ cacheTTL: 7d                                         â”‚   â”‚
â”‚  â”‚ â€¢ customPrompt: (å¯é€‰)                                 â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ custom-prompt.template (è‡ªå®šä¹‰Promptæ¨¡æ¿)                â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 4. æ ¸å¿ƒæµç¨‹

```
PRè§¦å‘ / Manual / API
   â”‚
   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è·å–ä»£ç å˜æ›´      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     æ˜¯     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç¼“å­˜æ£€æŸ¥         â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚ ä½¿ç”¨ç¼“å­˜      â”‚
â”‚ (ç‰ˆæœ¬å·+TTL)     â”‚     å¦    â”‚ (æ ‡æ³¨æ—¶é—´æˆ³)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å®Œæ•´åˆ†æé¡¹ç›®     â”‚ â”€â”€â†’ ç”Ÿæˆ project-context.md
â”‚ (è‡ªåŠ¨åˆ†æ+Skills)â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é€æ–‡ä»¶é£é™©è¯„ä¼°    â”‚
â”‚ (æŒ‰æ–‡ä»¶æ•°é€‰æ‹©ç­–ç•¥)â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç½®ä¿¡åº¦è®¡ç®—       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
    â”‚ è¾“å‡ºç»“æœ â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
         â”‚
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
    â–¼         â–¼
 PRè¯„è®º    æŠ¥å‘Šæ–‡ä»¶
(md+json)  (.codereview-agent/output/)
```

---

## 5. é£é™©ç­‰çº§å®šä¹‰

| ç­‰çº§ | å®šä¹‰ | ç¤ºä¾‹ |
|------|------|------|
| ğŸ”´ **é«˜é£é™©** | å®‰å…¨æ¼æ´ã€å…³é”®é€»è¾‘ã€ç ´åæ€§å˜æ›´ | SQLæ³¨å…¥ã€ç¡¬ç¼–ç å¯†é’¥ã€ç™»å½•é€»è¾‘ã€æ”¯ä»˜æµç¨‹ã€åˆ é™¤æ–‡ä»¶ã€schemaå˜æ›´ |
| ğŸŸ¡ **ä¸­é£é™©** | ä»£ç å¼‚å‘³ã€æ½œåœ¨bugã€å¯ç»´æŠ¤æ€§é—®é¢˜ | é‡å¤ä»£ç ã€é­”æ³•æ•°å­—ã€åºŸå¼ƒAPIã€ç©ºcatchå— |
| ğŸŸ¢ **ä½é£é™©** | é£æ ¼é—®é¢˜ã€æ ¼å¼ä¸è§„èŒƒ | å‘½åä¸ä¸€è‡´ã€trailing whitespaceã€ç¼ºå°‘æ³¨é‡Š |

---

## 6. åˆ¤æ–­é€»è¾‘

```
IF é«˜é£é™©é—®é¢˜ â‰¥ 1ä¸ª:
    â†’ ç»“è®º: éœ€äººå·¥å®¡æ ¸
    â†’ ç½®ä¿¡åº¦: 95% (é«˜ç¡®å®š)
ELIF ä¸­é£é™©é—®é¢˜ â‰¤ 2ä¸ª AND æ— é«˜é£é™©:
    â†’ ç»“è®º: å¯æäº¤
    â†’ ç½®ä¿¡åº¦: 100% - (ä¸­é£é™©Ã—10%) - (ä½é£é™©Ã—2%)
ELSE:
    â†’ ç»“è®º: éœ€äººå·¥å®¡æ ¸
    â†’ ç½®ä¿¡åº¦: 100% - (ä¸­é£é™©Ã—10%) - (ä½é£é™©Ã—2%)
```

---

## 7. ç¼“å­˜ç­–ç•¥

| æœºåˆ¶ | æè¿° |
|------|------|
| ç‰ˆæœ¬å·æ£€æµ‹ | é¦–æ¬¡åˆ†æè®°å½•é¡¹ç›®ç‰ˆæœ¬å·(package.jsonç­‰)ï¼Œä¸‹æ¬¡è¿è¡Œå¯¹æ¯”ï¼Œå˜åŒ–åˆ™é‡æ–°åˆ†æ |
| TTLè¿‡æœŸ | ç”¨æˆ·é…ç½®cacheTTLï¼Œé»˜è®¤7å¤©ï¼Œè¶…æœŸè‡ªåŠ¨é‡æ–°åˆ†æ |
| æ‰‹åŠ¨åˆ·æ–° | æ”¯æŒ @codereview-agent refresh æŒ‡ä»¤ |
| é€æ˜åº¦ | æŠ¥å‘Šä¸­æ ‡æ³¨ç¼“å­˜æ—¶é—´ï¼Œè®©ç”¨æˆ·åˆ¤æ–­ä¸Šä¸‹æ–‡æ–°é²œåº¦ |

---

## 8. å¤§æ‰¹é‡æ–‡ä»¶ç­–ç•¥

| æ–‡ä»¶æ•° | ç­–ç•¥ |
|--------|------|
| â‰¤ 5 | é€æ–‡ä»¶è¯¦ç»†review |
| 6-20 | å…¨éƒ¨reviewï¼Œæ‘˜è¦å‘ˆç° |
| 21-50 | é‡ç‚¹reviewå‰10ä¸ªå˜æ›´æœ€å¤§çš„ |
| > 50 | åªreviewå˜æ›´æœ€å¤§çš„20ä¸ª + æ•´ä½“é£é™©è¯„ä¼° |

---

## 9. LLM Provider æ”¯æŒ

| Provider | æœ€æ–°æ¨¡å‹ | APIæ ¼å¼ |
|----------|----------|---------|
| OpenAI | gpt-5.2, gpt-5.1, gpt-5, gpt-4o, gpt-4.1, o1, o3, o3-mini | OpenAIå…¼å®¹ |
| Anthropic | claude-opus-4.6, claude-sonnet-4.6, claude-opus-4.5, claude-sonnet-4.5, claude-haiku-4.5 | OpenAIå…¼å®¹ |
| æ™ºè°±AI | glm-5, glm-4-flash, glm-4.7, glm-4.6V, glm-4.5 | OpenAIå…¼å®¹ |
| MiniMax | MiniMax-M2.5, MiniMax-M2.1, abab6.5s-chat, abab6.5-chat | OpenAIå…¼å®¹ |
| é˜¿é‡Œäº‘ | qwen3-max, qwen3.5-plus, qwen-plus, qwen-turbo, qwen-long | OpenAIå…¼å®¹ |
| DeepSeek | deepseek-chat, deepseek-coder-v2, deepseek-v3, deepseek-v3.2 | OpenAIå…¼å®¹ |

---

## 10. è¾“å‡ºç¤ºä¾‹

### PRè¯„è®º

```
## CodeReview Agent

**ç»“è®º**: âœ… å¯æäº¤ (ç½®ä¿¡åº¦: 92%)

| æ–‡ä»¶ | é£é™© | é—®é¢˜æ•° |
|------|------|--------|
| src/auth/login.ts | ğŸŸ¡ ä¸­ | 2 |
| src/utils/helper.ts | ğŸŸ¢ ä½ | 3 |

[æŸ¥çœ‹å®Œæ•´æŠ¥å‘Š](./.codereview-agent/output/2024-01-15-report.md)
```

---

## 11. ç›®å½•ç»“æ„

```
codereview-agent/
â”œâ”€â”€ .github/
â”‚   â””â”€â”€ workflows/
â”‚       â””â”€â”€ codereview.yml      # GitHub Action
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ agents/
â”‚   â”‚   â”œâ”€â”€ analyzer.ts         # é¡¹ç›®åˆ†æAgent
â”‚   â”‚   â”œâ”€â”€ reviewer.ts         # å®¡æŸ¥Agent
â”‚   â”‚   â””â”€â”€ risk_calculator.ts # é£é™©è®¡ç®—
â”‚   â”œâ”€â”€ core/
â”‚   â”‚   â”œâ”€â”€ cache.ts            # ç¼“å­˜ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ config.ts          # é…ç½®åŠ è½½
â”‚   â”‚   â””â”€â”€ llm.ts             # LLMå°è£…
â”‚   â”œâ”€â”€ github/
â”‚   â”‚   â”œâ”€â”€ app.ts             # GitHub Appå¤„ç†
â”‚   â”‚   â””â”€â”€ comment.ts         # PRè¯„è®º
â”‚   â””â”€â”€ output/
â”‚       â””â”€â”€ generator.ts       # æŠ¥å‘Šç”Ÿæˆ
â”œâ”€â”€ docker/
â”‚   â””â”€â”€ Dockerfile
â”œâ”€â”€ .codereview-agent.yaml     # é…ç½®æ¨¡æ¿
â”œâ”€â”€ custom-prompt.template      # Promptæ¨¡æ¿
â””â”€â”€ README.md
```

---

## 12. ä½¿ç”¨æ–¹å¼

### GitHub App (æ¨è)

1. å®‰è£…åˆ°ä»“åº“
2. é…ç½® `.codereview-agent.yaml`
3. åˆ›å»ºPRè‡ªåŠ¨è§¦å‘

### GitHub Action

```yaml
- uses: your-org/codereview-agent@v1
  with:
    config: .codereview-agent.yaml
```

### Docker

```bash
docker run -v $(pwd):/app codereview-agent --pr 123
```
